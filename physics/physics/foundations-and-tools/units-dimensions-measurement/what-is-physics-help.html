<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>What is Physics ‚Äì Study Help ¬∑ PromptSchola Physics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="Targeted AI-powered study help for the nano-lesson 'What is Physics?' ‚Äì clarify definitions, fix misconceptions, and connect to later topics."
  />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- MathJax configuration for LaTeX rendering -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(','\\)'], ['$', '$']],
        displayMath: [['\\[','\\]'], ['$$','$$']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
  </script>

  <style>
    :root {
      --bg-body: #f3f4f6;
      --bg-card: #ffffff;
      --accent: #7e22ce;
      --accent-strong: #4c1d95;
      --accent-soft-border: rgba(129, 140, 248, 0.4);
      --text-main: #111827;
      --text-muted: #4b5563;
      --text-subtle: #9ca3af;
      --text-strong: #020617;
      --border-subtle: rgba(209, 213, 219, 0.7);
      --radius-card: 18px;
      --radius-pill: 999px;
      --shadow-card: 0 16px 35px rgba(15, 23, 42, 0.12);
      --font-main: 'Inter', system-ui, sans-serif;
      --transition-fast: 0.25s ease-out;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: var(--font-main);
      background: radial-gradient(circle at top, #e5e7eb, #f9fafb 45%, #f3f4f6);
      color: var(--text-main);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    a { text-decoration: none; color: inherit; }

    .page { min-height: 100vh; display: flex; flex-direction: column; }

    .container {
      max-width: 880px;
      margin: 0 auto;
      padding: 0 1.3rem;
    }

    /* NAV */
    header {
      position: sticky; top: 0; z-index: 40;
      backdrop-filter: blur(14px);
      background: rgba(249, 250, 251, 0.96);
      border-bottom: 1px solid rgba(209, 213, 219, 0.9);
    }

    .nav {
      display: flex; justify-content: space-between; align-items: center;
      padding: 0.75rem 0;
    }

    .logo-mark {
      width: 34px; height: 34px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, var(--accent), var(--accent-strong));
      display: flex; align-items: center; justify-content: center;
      font-weight: 800; color: #fff;
    }

    .logo-text span:first-child {
      font-weight: 700; font-size: 0.98rem; color: var(--text-strong);
    }
    .logo-text span:last-child {
      font-size: 0.72rem; color: var(--text-subtle);
    }

    .nav-links { display: flex; gap: 1.2rem; font-size: 0.88rem; }
    .nav-links a { opacity: .9; }
    .nav-links a:hover { color: var(--accent-strong); opacity: 1; }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      font-size: 0.82rem;
    }

    .btn-pill {
      border-radius: var(--radius-pill);
      padding: 0.45rem 1rem;
      background: #ffffff;
      border: 1px solid rgba(209, 213, 219, 0.9);
      font-size: 0.8rem;
      transition: var(--transition-fast);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      white-space: nowrap;
    }
    .btn-pill:hover {
      background: #f3f4f6; transform: translateY(-1px);
    }

    @media (max-width: 860px) {
      .nav-links { display: none; }
    }

    main { padding-bottom: 2.5rem; }

    /* HERO */
    .hero {
      padding: 2.4rem 0 1.6rem;
      text-align: left;
    }

    .hero-kicker {
      font-size: 0.76rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--text-subtle);
    }

    .hero-title {
      font-size: clamp(1.6rem, 2.5vw, 2rem);
      font-weight: 800;
      color: var(--text-strong);
      margin: 0.4rem 0 0.1rem;
    }

    .hero-subtitle {
      font-size: 0.94rem;
      color: var(--text-muted);
      max-width: 36rem;
    }

    .hero-breadcrumbs {
      margin-top: 0.7rem;
      font-size: 0.82rem;
      color: var(--text-subtle);
    }
    .hero-breadcrumbs a { color: var(--accent-strong); }

    /* Banner */
    .help-banner {
      margin: 0.8rem auto 1.7rem;
      max-width: 720px;
      border-radius: var(--radius-pill);
      padding: 0.6rem 0.9rem;
      background: linear-gradient(to right, #eef2ff, #e0f2fe);
      border: 1px solid var(--accent-soft-border);
      font-size: 0.8rem;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      gap: 0.8rem;
      flex-wrap: wrap;
    }

    .badge-topic {
      padding: 0.16rem 0.7rem;
      border-radius: var(--radius-pill);
      font-size: 0.74rem;
      background: #ede9fe;
      border: 1px solid rgba(129, 140, 248, 0.9);
      color: #4c1d95;
      font-weight: 600;
    }

    /* Help card */
    .help-card {
      background: var(--bg-card);
      border-radius: var(--radius-card);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-card);
      padding: 1.2rem 1.3rem 1.2rem;
      font-size: 0.9rem;
    }

    .help-card-header {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
      margin-bottom: 0.65rem;
    }

    .help-chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      align-items: center;
    }

    .help-chip {
      padding: 0.16rem 0.7rem;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(209, 213, 219, 0.9);
      font-size: 0.72rem;
      color: var(--text-subtle);
      background: #f9fafb;
    }

    .help-topic-pill {
      padding: 0.16rem 0.65rem;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(126, 34, 206, 0.4);
      font-size: 0.74rem;
      color: #4c1d95;
      background: #f5f3ff;
      font-weight: 600;
    }

    .help-title {
      font-size: 1.02rem;
      font-weight: 650;
      color: var(--text-strong);
    }

    .help-lead {
      font-size: 0.86rem;
      color: var(--text-muted);
    }

    .help-body-layout {
      margin-top: 0.9rem;
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1.4fr);
      gap: 1rem;
      align-items: flex-start;
    }

    @media (max-width: 860px) {
      .help-body-layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .prompt-box {
      border-radius: 14px;
      border: 1px solid rgba(209, 213, 219, 0.9);
      background: #f9fafb;
      padding: 0.9rem 1rem 0.9rem;
      font-size: 0.84rem;
      color: var(--text-muted);
      min-height: 135px;
      white-space: pre-wrap;
    }

    .prompt-box-header {
      font-size: 0.78rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-subtle);
      margin-bottom: 0.45rem;
    }

    .prompt-box-body {
      font-family: var(--font-main);
    }

    .ai-box {
      border-radius: 14px;
      border: 1px solid rgba(129, 140, 248, 0.35);
      background: #ffffff;
      padding: 1rem 1.1rem;
      min-height: 135px;
      font-size: 0.94rem;
      color: #111827;
      white-space: pre-wrap;
      line-height: 1.7;
    }

    .ai-box p { margin-bottom: 0.9rem; }
    .ai-box ul,
    .ai-box ol { margin: 0.7rem 0 0.7rem 1.3rem; }

    .ai-box strong {
      font-weight: 700;
      color: inherit;
    }

    .ai-box em { font-style: italic; }

    .ai-box .mjx-container[jax="CHTML"] {
      margin: 0.9rem 0;
      font-size: 1.05em;
    }

    .help-actions-row {
      margin-top: 0.8rem;
      display: flex;
      justify-content: space-between;
      gap: 0.6rem;
      flex-wrap: wrap;
      font-size: 0.8rem;
      color: var(--text-subtle);
    }

    .help-actions-buttons {
      display: flex;
      gap: 0.4rem;
      flex-wrap: wrap;
    }

    .btn-ghost,
    .btn-primary {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }

    .btn-ghost {
      padding: 0.4rem 0.85rem;
      border-radius: var(--radius-pill);
      font-size: 0.8rem;
      border: 1px solid rgba(209, 213, 219, 0.9);
      background: #ffffff;
      cursor: pointer;
      transition: var(--transition-fast);
    }
    .btn-ghost:hover {
      background: #f3f4f6;
      transform: translateY(-1px);
    }

    .btn-primary {
      padding: 0.42rem 1rem;
      border-radius: var(--radius-pill);
      font-size: 0.8rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      background: radial-gradient(circle at 30% 0%, #a855f7, #7e22ce, #4c1d95);
      color: #fff;
      box-shadow: 0 10px 22px rgba(79, 70, 229, 0.35);
      transition: var(--transition-fast);
    }
    .btn-primary:hover { transform: translateY(-1px); }

    .btn-copy {
      font-size: 0.76rem;
      padding: 0.3rem 0.8rem;
    }

    footer {
      margin-top: auto;
      padding: 1.8rem 0;
      text-align: center;
      font-size: 0.8rem;
      color: var(--text-subtle);
    }
  </style>
</head>

<body>
<div class="page">

  <!-- NAV -->
  <header>
    <div class="container">
      <div class="nav">
        <div style="display:flex;align-items:center;gap:0.75rem;">
          <div class="logo-mark">P</div>
          <div class="logo-text">
            <span>PromptSchola</span>
            <span>Prompt-based Physics mastery</span>
          </div>
        </div>

        <nav class="nav-links">
          <a href="index.html">Home</a>
          <a href="physics.html">Physics</a>
          <a href="pricing.html">Pricing</a>
        </nav>

        <div class="nav-right">
          <!-- Filled by auth.js -->
          <span id="nav-user" style="font-size:0.78rem;color:#9ca3af;"></span>

          <!-- Shown when logged OUT -->
          <a id="nav-login-btn" href="auth.html" class="btn-pill">Sign In</a>
          <a id="nav-register-btn" href="auth.html?mode=signup" class="btn-pill">Register</a>

          <!-- Shown when logged IN -->
          <button
            id="nav-signout-btn"
            type="button"
            class="btn-pill"
            style="display:none;"
          >
            Sign out
          </button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- HERO -->
    <section class="hero">
      <div class="container">
        <div class="hero-kicker">Study help ¬∑ What is Physics?</div>
        <h1 class="hero-title">Targeted prompts for ‚ÄúWhat is Physics?‚Äù</h1>
        <p class="hero-subtitle">
          You arrived here from a side-panel link in the nano-lesson. This page shows one focused study prompt
          you can run with AI or copy into another chat when you need extra help.
        </p>
        <div class="hero-breadcrumbs">
          <a href="physics.html">Physics</a> ¬∑
          <a href="nano-what-is-physics.html">Nano-lesson: What is Physics?</a> ¬∑
          <span>Study help</span>
        </div>
      </div>
    </section>

    <!-- BANNER -->
    <section>
      <div class="container">
        <div class="help-banner">
          <span class="badge-topic">What is Physics?</span>
          <span>
            This page loads a specific help prompt based on the link you clicked. You can always change it using the
            ‚ÄúCurrent prompt‚Äù selector below.
          </span>
        </div>
      </div>
    </section>

    <!-- HELP CARD -->
    <section>
      <div class="container">
        <article class="help-card">
          <div class="help-card-header">
            <div class="help-chip-row">
              <span id="help-category-pill" class="help-chip">Category: ‚Ä¶</span>
              <span class="help-topic-pill">Study help ¬∑ What is Physics?</span>
            </div>
            <h2 id="help-title" class="help-title">
              Loading prompt‚Ä¶
            </h2>
            <p id="help-lead" class="help-lead">
              Please wait while the prompt loads.
            </p>
          </div>

          <div class="help-body-layout">
            <!-- LEFT: Prompt preview -->
            <div>
              <div class="prompt-box">
                <div class="prompt-box-header">Prompt (you can edit before running)</div>
                <div id="prompt-text" class="prompt-box-body">
                  Loading prompt text‚Ä¶
                </div>
              </div>
            </div>

            <!-- RIGHT: AI output -->
            <div>
              <div id="ai-output" class="ai-box">
                Run with AI to see a guided explanation here.
              </div>
            </div>
          </div>

          <div class="help-actions-row">
            <div class="help-actions-buttons">
              <button class="btn-ghost btn-copy" type="button" onclick="copyCurrentPrompt()">
                Copy prompt
              </button>
              <button class="btn-ghost btn-copy" type="button" onclick="copyCurrentAnswer()">
                Copy answer
              </button>
              <button class="btn-primary" type="button" onclick="runCurrentPromptWithAI()">
                Run with AI
              </button>
            </div>
            <div>
              <span id="help-footnote">
                Tip: You can paste this prompt into any AI chat if you prefer to keep this page for notes.
              </span>
            </div>
          </div>
        </article>
      </div>
    </section>
  </main>

  <footer>
    ¬© 2025 PromptSchola. All rights reserved.
  </footer>
</div>

<!-- üîπ Supabase + shared auth helpers for nav -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="auth.js"></script>

<script>
  // Library of help prompts for "What is Physics?"
  // Keys (W1..W10) match the IDs used in nano-what-is-physics side panel links.
  const helpPromptLibrary = {
    W1: {
      id: 'W1',
      category: 'Confusions & look-alikes',
      title: 'What exactly counts as ‚Äúphysics‚Äù compared to other sciences?',
      lead: 'Use this when you are not sure which questions belong to physics vs chemistry, biology, or everyday ‚Äúscience news.‚Äù',
      prompt: `You are a Physics tutor.

Explain clearly what kinds of questions and problems belong to **physics** compared to other sciences.

Cover ALL of the following:

‚Ä¢ What physics mainly studies (for example, matter, energy, forces, motion, space, time)
‚Ä¢ Examples of questions that are clearly physics (for example, why objects fall, how light travels, how electricity works)
‚Ä¢ Examples that are more chemistry, biology, or earth science
‚Ä¢ How different sciences can overlap on the same real-world situation (for example, climate, medicine, energy, technology)

Use short paragraphs and bullet points. Keep the language friendly and concrete, as if you are talking to a final-year high school student.

If you include any equations, write them in LaTeX display mode on their own line, like:
  \\[ F = ma \\]

Do NOT use LaTeX environments like align. Do not use markdown headings like # or ###; use bold text for key ideas instead.`
    },

    W2: {
      id: 'W2',
      category: 'Confusions & look-alikes',
      title: 'Physics vs chemistry vs math vs engineering: who studies what?',
      lead: 'Use this when the roles of physics, math, chemistry, and engineering feel mixed up in your head.',
      prompt: `You are a Physics tutor.

Compare, in a clear and friendly way, the roles of **physics**, **mathematics**, **chemistry**, and **engineering**.

Cover ALL of these points:

‚Ä¢ What physics focuses on (ideas, laws, and models of nature)
‚Ä¢ What mathematics focuses on (patterns, structures, and logic)
‚Ä¢ What chemistry focuses on (substances, reactions, and molecular-level changes)
‚Ä¢ What engineering focuses on (designing and building devices, systems, and technology)
‚Ä¢ At least one example problem or career that shows how these four areas work together

Use bullet points and short examples. Make the differences feel natural, not like rigid boxes.

If you write equations, put each one in LaTeX display mode, for example:
  \\[ v = \\frac{\\Delta x}{\\Delta t} \\]

Avoid markdown headings like # or ###. Use bold text instead when you want to emphasise key terms.`
    },

    W3: {
      id: 'W3',
      category: 'Tricky areas & exam traps',
      title: 'Why exam definitions of physics feel different from everyday explanations',
      lead: 'Use this when textbook or exam-style definitions feel stiff compared to how people talk about physics in real life.',
      prompt: `You are a Physics tutor.

Explain why the **formal definition** of physics in exams and textbooks can feel different from everyday explanations.

Do ALL of the following:

‚Ä¢ Give a typical exam-style definition of physics
‚Ä¢ Give a more everyday, story-style explanation of physics
‚Ä¢ Show how both are actually describing the same subject from different angles
‚Ä¢ Explain how to remember the key parts of a formal definition without just memorising words

Use short paragraphs and a few bullet points. Include at least one simple ‚Äúmemory hook‚Äù or analogy (for example, ‚Äúphysics is the grammar of nature‚Äù).

If you include equations, place them in LaTeX display mode like:
  \\[ F = ma \\]

Do not use markdown headings like # or ###. Use bold text for important words instead.`
    },

    W4: {
      id: 'W4',
      category: 'Tricky areas & exam traps',
      title: 'How exam questions hide ‚Äúwhat physics studies‚Äù inside short word problems',
      lead: 'Use this when you can read a question but do not see how it is actually testing your understanding of what physics studies.',
      prompt: `You are a Physics tutor.

Show how exam questions about ‚ÄúWhat is Physics?‚Äù can be hidden inside short word problems or everyday situations.

Do ALL of the following:

‚Ä¢ Give 3‚Äì4 short example questions that are really asking what physics studies (for example, about falling objects, light, sound, or electricity)
‚Ä¢ For each example, explain what part of physics it belongs to and what big idea it is really testing
‚Ä¢ Give simple tips for spotting when a question is really about ‚Äúwhat physics studies‚Äù rather than just plugging numbers into formulas

Use bullet points and clear steps. Focus on thinking, not heavy calculations.

If you include equations, write them in LaTeX display mode on their own lines, like:
  \\[ v = u + at \\]

Do not use markdown headings like # or ###. Use bold text for key terms instead.`
    },

    W5: {
      id: 'W5',
      category: 'Common mistakes',
      title: 'Thinking physics is only about solving equations',
      lead: 'Use this when physics feels like a long list of formulas and you cannot see the ideas behind them.',
      prompt: `You are a Physics tutor.

Help a student who believes that physics is ‚Äújust solving equations‚Äù to see the **conceptual** side of the subject.

Cover ALL of the following:

‚Ä¢ Why equations in physics are really short ways of writing big ideas about nature
‚Ä¢ One or two examples where you start from an idea and then show the equation (for example, ‚Äúmore force ‚Üí more acceleration‚Äù leading to \\( F = ma \\))
‚Ä¢ How diagrams, words, and everyday examples matter just as much as algebra
‚Ä¢ Practical advice on how to study physics so you always look for the idea first and the equation second

Use short paragraphs and a few bullet points. Keep the tone encouraging.

Write any equations in LaTeX display mode, for example:
  \\[ F = ma \\]

Do not use markdown headings like # or ###. Use bold text for key ideas instead.`
    },

    W6: {
      id: 'W6',
      category: 'Common mistakes',
      title: 'Believing physics is just memorizing formulas and constants',
      lead: 'Use this when you feel pressure to memorize every formula but are not sure what actually matters.',
      prompt: `You are a Physics tutor.

Explain why physics is **not** mainly about memorising formulas and constants, and show a better way to remember what matters.

Do ALL of the following:

‚Ä¢ Explain why understanding relationships (how one quantity affects another) is more important than memorising many separate formulas
‚Ä¢ Give practical tips for organising formulas into a few ‚Äúfamilies‚Äù (for example, motion, forces, energy)
‚Ä¢ Describe how units and dimensions can help you reconstruct or check formulas when you forget them
‚Ä¢ Offer a simple, concrete study routine that focuses on ideas, units, and a small core set of formulas

Use bullet points and friendly language.

Place any equations in LaTeX display mode, for example:
  \\[ v = u + at \\]
  \\[ E = \\tfrac{1}{2}mv^2 \\]

Do not use markdown headings like # or ###. Use bold text when you want to emphasise something.`
    },

    W7: {
      id: 'W7',
      category: 'When you feel stuck',
      title: 'How to read a physics paragraph and turn it into a simple picture',
      lead: 'Use this when reading about physics feels like reading a block of text with no clear mental image.',
      prompt: `You are a Physics tutor.

Teach a student a simple method for turning a **paragraph about physics** into a **mental picture or sketch**.

Cover ALL of these:

‚Ä¢ A step-by-step process: first read, then underline key objects and actions, then sketch
‚Ä¢ At least one worked example where you start from a short physics description and end with a very simple diagram or picture
‚Ä¢ How this habit helps with later topics like mechanics, fields, and waves
‚Ä¢ A short checklist they can use every time they read a new physics passage

Use numbered or bulleted steps. Keep the drawings ‚Äúdescribed in words‚Äù (the student will draw them themselves).

If you use equations, put them in LaTeX display mode on their own line, like:
  \\[ a = \\frac{\\Delta v}{\\Delta t} \\]

Avoid markdown headings. Use bold text for key steps instead.`
    },

    W8: {
      id: 'W8',
      category: 'When you feel stuck',
      title: 'What to do when ‚Äúwhat physics is‚Äù still does not feel clear',
      lead: 'Use this when you have seen several explanations of physics but it still feels fuzzy.',
      prompt: `You are a Physics tutor.

Guide a student who has already read a definition of physics but still feels that ‚Äúwhat physics is‚Äù is fuzzy.

Do ALL of the following:

‚Ä¢ Offer a very short, plain-language definition of physics
‚Ä¢ Give 3‚Äì4 concrete examples from daily life that quietly use physics ideas (for example, using a phone, riding a bicycle, cooking)
‚Ä¢ Explain how the same few core questions (about motion, forces, energy, and interactions) appear again and again in different topics
‚Ä¢ Suggest a simple reflection exercise they can do after each lesson to connect new ideas back to ‚Äúwhat physics is‚Äù

Use short paragraphs and bullet points. Keep the tone reassuring.

If you include equations, write them in LaTeX display mode, for example:
  \\[ F = ma \\]

Do not use markdown headings like # or ###. Use bold text for emphasis instead.`
    },

    W9: {
      id: 'W9',
      category: 'Concept bridges',
      title: 'How this intro topic prepares you for Mechanics and later physics',
      lead: 'Use this when you want to see how this nano-lesson connects to the rest of the course.',
      prompt: `You are a Physics tutor.

Show how the nano-lesson ‚ÄúWhat is Physics?‚Äù prepares a student for **Mechanics** and later physics topics.

Cover ALL of these points:

‚Ä¢ How understanding ‚Äúwhat physics studies‚Äù makes it easier to see what Mechanics is really about (motion, forces, energy)
‚Ä¢ How ideas like ‚Äúphysical quantity,‚Äù ‚Äúmodel,‚Äù and ‚Äúlaw of nature‚Äù keep reappearing in every chapter
‚Ä¢ Examples of questions from Mechanics that are really just detailed versions of the big questions introduced here
‚Ä¢ One short ‚Äúroadmap‚Äù sentence that connects this nano-lesson to the next few topics a student will likely meet

Use short paragraphs and bullet points.

If you use equations, write each in LaTeX display mode, for example:
  \\[ F = ma \\]
  \\[ v = \\frac{\\Delta x}{\\Delta t} \\]

Do not use markdown headings. Use bold text instead when you highlight key ideas.`
    },

    W10: {
      id: 'W10',
      category: 'Concept bridges',
      title: 'How understanding ‚Äúwhat physics is‚Äù connects to real careers and technology',
      lead: 'Use this when you want to know why this topic matters beyond passing an exam.',
      prompt: `You are a Physics tutor.

Explain how understanding ‚Äúwhat physics is‚Äù connects to **real careers** and **modern technology**.

Do ALL of the following:

‚Ä¢ Give examples of technologies that rely heavily on physics ideas (for example, smartphones, medical imaging, renewable energy, space missions)
‚Ä¢ Connect each example to the kind of questions physics tries to answer
‚Ä¢ Mention a few broad career paths where physics thinking is valuable (for example, engineering, data science, finance, research, climate science)
‚Ä¢ Encourage the student by showing that learning what physics is changes how they see and reason about the world, even outside of science

Use bullet points and short, vivid examples.

If you include equations, put them in LaTeX display mode on their own line, like:
  \\[ E = mc^2 \\]

Do not use markdown headings like # or ###. Use bold text when you want to emphasise key ideas.`
    }
  };

  let currentHelpId = null;
  let lastAiAnswer = '';

  // Canonical PromptSchola formatOutput (with HTML escaping + LaTeX normalization)
  function formatOutput(text) {
    if (!text) return '';

    // 1) HTML-escape first
    let safe = text
      .replace(/&/g, '&amp;')
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;');

    // 2) Normalize escaped LaTeX:
    //    \\[ ... \\] ‚Üí \[ ... \]
    //    \\( ... \\) ‚Üí \( ... \)
    safe = safe
      .replace(/\\\\\[/g, '\\[')
      .replace(/\\\\\]/g, '\\]')
      .replace(/\\\\\(/g, '\\(')
      .replace(/\\\\\)/g, '\\)');

    // 3) Convert markdown headings (### etc.) into bold lines
    safe = safe.replace(/^#{1,6}\s+(.+)$/gm, '<strong>$1</strong>');

    // 4) Convert markdown bullets (- or *) into ‚Ä¢
    safe = safe.replace(/^\s*[-*]\s+/gm, '‚Ä¢ ');

    // 5) Bold and italic markdown
    safe = safe.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
    safe = safe.replace(/\*(.+?)\*/g, '<em>$1</em>');

    // 6) Paragraph spacing: double newlines ‚Üí paragraph break
    safe = safe.replace(/\n\n+/g, '</p><p>');

    // 7) Remaining single newlines ‚Üí <br>
    safe = safe.replace(/\n/g, '<br>');

    // 8) Wrap in <p> tag
    safe = '<p>' + safe + '</p>';

    return safe;
  }

  function loadHelpPromptFromUrl() {
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id') || 'W1';
    const entry = helpPromptLibrary[id] || helpPromptLibrary['W1'];
    currentHelpId = entry.id;

    const categoryPill = document.getElementById('help-category-pill');
    const titleEl = document.getElementById('help-title');
    const leadEl = document.getElementById('help-lead');
    const promptTextEl = document.getElementById('prompt-text');
    const aiOutputEl = document.getElementById('ai-output');

    if (categoryPill) {
      categoryPill.textContent = 'Category: ' + (entry.category || 'Study help');
    }
    if (titleEl) {
      titleEl.textContent = entry.title || 'Study help prompt';
    }
    if (leadEl) {
      leadEl.textContent = entry.lead || '';
    }
    if (promptTextEl) {
      promptTextEl.textContent = entry.prompt || '';
    }
    if (aiOutputEl) {
      aiOutputEl.textContent = 'Run with AI to see a guided explanation here.';
    }

    lastAiAnswer = '';
  }

  async function runCurrentPromptWithAI() {
    if (!currentHelpId || !helpPromptLibrary[currentHelpId]) {
      alert('No prompt selected yet.');
      return;
    }

    const prompt = helpPromptLibrary[currentHelpId].prompt;
    const aiOutputEl = document.getElementById('ai-output');
    if (!aiOutputEl) return;

    try {
      aiOutputEl.textContent = 'Running with AI‚Ä¶';

      const res = await fetch('/api/run-step', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt })
      });

      if (!res.ok) {
        aiOutputEl.textContent = 'There was an error contacting the AI. Please try again later.';
        return;
      }

      const data = await res.json();
      const raw = data.content || 'No response received from AI.';
      lastAiAnswer = raw;
      aiOutputEl.innerHTML = formatOutput(raw);

      if (window.MathJax && window.MathJax.typesetPromise) {
        MathJax.typesetPromise([aiOutputEl]).catch(err =>
          console.error('MathJax error in response:', err)
        );
      }
    } catch (err) {
      console.error(err);
      aiOutputEl.textContent = 'Unexpected error. Please try again.';
    }
  }

  function copyCurrentPrompt() {
    if (!currentHelpId || !helpPromptLibrary[currentHelpId]) {
      alert('No prompt selected yet.');
      return;
    }
    const prompt = helpPromptLibrary[currentHelpId].prompt;
    if (!navigator.clipboard || !navigator.clipboard.writeText) {
      alert('Clipboard not supported in this browser.');
      return;
    }
    navigator.clipboard.writeText(prompt)
      .then(() => { alert('Prompt copied to clipboard.'); })
      .catch(err => {
        console.error(err);
        alert('Could not copy prompt. Please try again.');
      });
  }

  function copyCurrentAnswer() {
    if (!lastAiAnswer) {
      alert('No AI answer to copy yet. Run with AI first.');
      return;
    }
    if (!navigator.clipboard || !navigator.clipboard.writeText) {
      alert('Clipboard not supported in this browser.');
      return;
    }
    navigator.clipboard.writeText(lastAiAnswer)
      .then(() => { alert('Answer copied to clipboard.'); })
      .catch(err => {
        console.error(err);
        alert('Could not copy answer. Please try again.');
      });
  }

  document.addEventListener('DOMContentLoaded', () => {
    // Load prompt from URL
    loadHelpPromptFromUrl();

    // Initial MathJax typeset (for any LaTeX in prompt text)
    if (window.MathJax && window.MathJax.typesetPromise) {
      MathJax.typesetPromise().catch(err =>
        console.error('MathJax initial typeset error:', err)
      );
    }

    // Update nav based on auth state
    if (typeof updateNavUserDisplay === 'function') {
      updateNavUserDisplay();
    }

    const signOutBtn = document.getElementById('nav-signout-btn');
    if (signOutBtn && typeof signOutUser === 'function') {
      signOutBtn.addEventListener('click', signOutUser);
    }
  });
</script>

</body>
</html>
